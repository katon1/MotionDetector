import serial
import time
from plyer import notification

# Set up the serial connection (adjust the port as needed)
arduino = serial.Serial('COM11', 9600, timeout=1)
time.sleep(2)  # Allow time for the connection to establish

def show_notification(title, message):
    notification.notify(
        title=title,
        message=message,
        app_icon='../test/test.txt',  # e.g. 'path/to/icon.png'
        timeout=10,  # seconds
    )

print("Waiting for motion detection...")

while True:
    if arduino.in_waiting:
        message = arduino.readline().decode('utf-8').strip()
        if message == "Motion detected!":
            print(message)
            show_notification("Motion Detector", "Someone walked past!")
            time.sleep(3)  # Wait 5 seconds
            show_notification("Motion Detector", "Fuck you, Kidney")
        elif message == "Motion stopped!":
            print(message)
    time.sleep(0.1)
